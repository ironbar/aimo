
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ironbar.github.io/aimo/modeling/Iteration_01_overfit/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.15">
    
    
      
        <title>Iteration 1. Overfit the train set - aimo</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.c382b1dc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#iteration-1-overfit-the-train-set" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="aimo" class="md-header__button md-logo" aria-label="aimo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            aimo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Iteration 1. Overfit the train set
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ironbar/aimo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../01_Business_Understanding/" class="md-tabs__link">
      Business Understanding
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../02_Data_Understanding/" class="md-tabs__link">
      Data Understanding
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../03_State_of_the_art/" class="md-tabs__link">
      State of the art
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Modeling
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../utils/00_Challenge_Workflow/" class="md-tabs__link">
        Utils
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="aimo" class="md-nav__button md-logo" aria-label="aimo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    aimo
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ironbar/aimo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../01_Business_Understanding/" class="md-nav__link">
        Business Understanding
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../02_Data_Understanding/" class="md-nav__link">
        Data Understanding
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../03_State_of_the_art/" class="md-nav__link">
        State of the art
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Modeling</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Modeling" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Modeling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Iteration 1. Overfit the train set
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Iteration 1. Overfit the train set
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#goal" class="md-nav__link">
    Goal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    Motivation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development" class="md-nav__link">
    Development
  </a>
  
    <nav class="md-nav" aria-label="Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#which-parameters-or-changes-i-can-make-to-improve-the-results" class="md-nav__link">
    Which parameters or changes I can make to improve the results?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-the-best-way-to-use-deepseekmath" class="md-nav__link">
    What is the best way to use DeepSeekMath?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idea-most-authoritative-result-is-from-boxed" class="md-nav__link">
    Idea: Most authoritative result is from boxed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    Results
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p100-vs-2xt4" class="md-nav__link">
    P100 vs 2xT4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zero-shot-vs-few-shot-instruction-following" class="md-nav__link">
    Zero shot vs Few shot instruction following
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-problem-optimization-problem-1" class="md-nav__link">
    Single problem optimization: Problem 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheating-to-overfit-on-train-set" class="md-nav__link">
    Cheating to overfit on train set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-repetitions" class="md-nav__link">
    Number of repetitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-output-tokens" class="md-nav__link">
    Max output tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature" class="md-nav__link">
    Temperature
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    TODO
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_02_MATH_dataset/" class="md-nav__link">
        Iteration 2. MATH dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_03_prompt_engineering/" class="md-nav__link">
        Iteration 3. Prompt engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_04_answer_validation/" class="md-nav__link">
        Iteration 4. Answer validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_05_vllm/" class="md-nav__link">
        Iteration 5. VLLM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_06_different_models/" class="md-nav__link">
        Iteration n. Iteration_title
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_07_tweak_inference_parameters/" class="md-nav__link">
        Iteration n. Iteration_title
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_08_fine-tuning/" class="md-nav__link">
        Iteration 8. Fine-tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_09_hinting_the_model/" class="md-nav__link">
        Iteration 9. Giving hints to the model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Iteration_10_select_submission/" class="md-nav__link">
        Iteration 10. Select submissions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utils" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/00_Challenge_Workflow/" class="md-nav__link">
        Challenge workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/markdown_cheatsheet/" class="md-nav__link">
        Markdown cheatsheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/methodology/" class="md-nav__link">
        Methodology
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#goal" class="md-nav__link">
    Goal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    Motivation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development" class="md-nav__link">
    Development
  </a>
  
    <nav class="md-nav" aria-label="Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#which-parameters-or-changes-i-can-make-to-improve-the-results" class="md-nav__link">
    Which parameters or changes I can make to improve the results?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-the-best-way-to-use-deepseekmath" class="md-nav__link">
    What is the best way to use DeepSeekMath?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idea-most-authoritative-result-is-from-boxed" class="md-nav__link">
    Idea: Most authoritative result is from boxed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    Results
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p100-vs-2xt4" class="md-nav__link">
    P100 vs 2xT4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zero-shot-vs-few-shot-instruction-following" class="md-nav__link">
    Zero shot vs Few shot instruction following
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-problem-optimization-problem-1" class="md-nav__link">
    Single problem optimization: Problem 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheating-to-overfit-on-train-set" class="md-nav__link">
    Cheating to overfit on train set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-repetitions" class="md-nav__link">
    Number of repetitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-output-tokens" class="md-nav__link">
    Max output tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature" class="md-nav__link">
    Temperature
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    TODO
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/ironbar/aimo/edit/master/docs/modeling/Iteration_01_overfit.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="iteration-1-overfit-the-train-set">Iteration 1. Overfit the train set</h1>
<p><em>25-04-2024</em></p>
<h2 id="goal">Goal</h2>
<p>Can I get a perfect score on the train set?</p>
<h2 id="motivation">Motivation</h2>
<p>I have spend two days refactoring the <a href="https://www.kaggle.com/code/abdurrafae/improved-code-interpretation">Early Sharing Prize Notebook</a> and now I have a clean code notebook that will allow to do agile changes and iterations.</p>
<p>The notebook uses DeepSeekMath model with a code interpreter to solve math problems. There are many
parameters and parts of the code to tweak.</p>
<p>The train set is small, but that would enable faster evaluation than using other datasets. Once
I'm able to overfit to the train set I could expand to other datasets.</p>
<h2 id="development">Development</h2>
<h3 id="which-parameters-or-changes-i-can-make-to-improve-the-results">Which parameters or changes I can make to improve the results?</h3>
<ul>
<li>Prompt. I can modify the prompt or use few-shot prompting.</li>
<li>Temperature. I could modify the <code>temperature</code> and <code>top_p</code> parameters that guide text generation.</li>
<li>Dealing with the output. There are many output: boxed output, code output, text output... Can I
  find a better way to aggregate the information?</li>
<li>Does quantization affect to the results?</li>
<li>Dealing with code. I have seen problems when parsing the code from the model. Maybe have two
  conditions: one for starting code generation and another for ending.</li>
<li>How many repetitions?</li>
</ul>
<p>Finally being able to increase inference speed would enable for faster evaluation and also to run more repetitions on inference.</p>
<h3 id="what-is-the-best-way-to-use-deepseekmath">What is the best way to use DeepSeekMath?</h3>
<ul>
<li><a href="https://arxiv.org/abs/2402.03300">DeepSeekMath Paper</a>. Are there clues in the paper of how to prompt the model, inference configuration...?
  No, the paper does not give too much details of the evaluation. It only mentions that <code>few-shot chain of thought prompting</code> was used. It does not
  show which prompts or parameters were used.</li>
<li><a href="https://github.com/deepseek-ai/DeepSeek-Math">DeepSeekMath Github repo</a>. Explore the repo to find examples of use.</li>
<li><a href="https://github.com/OpenBMB/OlympiadBench">OlympiadBench Github repo</a>. Here they use DeepSeekMath.</li>
</ul>
<h3 id="idea-most-authoritative-result-is-from-boxed">Idea: Most authoritative result is from boxed</h3>
<p>If I use examples that output boxed that should be the relevant result, because it is an intelligent LLM parsing the result for me.</p>
<p>Naive parsing the response from the text does not have sense. Especially if the limit of characters is reached.</p>
<h2 id="results">Results</h2>
<h3 id="p100-vs-2xt4">P100 vs 2xT4</h3>
<p>The following table shows inference speed in tokens/second.</p>
<table>
<thead>
<tr>
<th>GPU \ Precision</th>
<th>4bit</th>
<th>16bit</th>
</tr>
</thead>
<tbody>
<tr>
<td>P100</td>
<td>12.5</td>
<td>18.7</td>
</tr>
<tr>
<td>2xT4</td>
<td>11.7</td>
<td>15.2</td>
</tr>
</tbody>
</table>
<p>My experiments show that P100 is slightly faster than 2xT4. The drawback is that <code>OOM</code> errors can arise
when using the 16 bit model.</p>
<p>It is likely that using the 2xT4 in parallel (loading the model in both gpus and making inferences like a server) will beat this speeds.</p>
<p>Links to forum posts:</p>
<ul>
<li><a href="https://www.kaggle.com/competitions/ai-mathematical-olympiad-prize/discussion/492578">https://www.kaggle.com/competitions/ai-mathematical-olympiad-prize/discussion/492578</a></li>
<li><a href="https://www.kaggle.com/competitions/ai-mathematical-olympiad-prize/discussion/493345">https://www.kaggle.com/competitions/ai-mathematical-olympiad-prize/discussion/493345</a></li>
</ul>
<h3 id="zero-shot-vs-few-shot-instruction-following">Zero shot vs Few shot instruction following</h3>
<p>I have found that the model tends to ignore the instructions. It is much better at imitating the style of the few-shot prompt.</p>
<p>The most clear evidence comes from the instruction that asks to use <code>boxed</code> format
for highlighting the answer.</p>
<table>
<thead>
<tr>
<th>prompt</th>
<th>temperature</th>
<th>responses with boxed</th>
</tr>
</thead>
<tbody>
<tr>
<td>zero-shot</td>
<td>1</td>
<td>31%</td>
</tr>
<tr>
<td>3-shot</td>
<td>1</td>
<td>74%</td>
</tr>
<tr>
<td>3-shot</td>
<td>0.5</td>
<td>79%</td>
</tr>
<tr>
<td>3-shot</td>
<td>0.1</td>
<td>80%</td>
</tr>
</tbody>
</table>
<p>Despite the model being clearly required to use the format in the response it ignored
it on 69% of the responses, which is wild for an assistant. When being given 3 examples
it doubles the responses with boxed, but it is still far from 100%.</p>
<p>Lowering the temperature also seems to force the model to follow the instructions closely.</p>
<p>Thus it seems pretty clear that the correct way to prompt this model is using
few-shot prompts. That might enable to get rid of naively parsing the last integer.</p>
<h3 id="single-problem-optimization-problem-1">Single problem optimization: Problem 1</h3>
<p>I have downloaded the notebook to my PC and it is running at around 30 token/s. I'm thinking of doing
a single problem optimization. Focus on a specific problem and run the solution search multiple times
maximizing the probability of getting the correct answers. Each run could take a few minutes so
the optimization speed would be nice.</p>
<p>The goal is to write python code that solves the problem.</p>
<ol>
<li>Initial attempts with few-shot prompt from DeepSeekMath repo cannot solve the problem</li>
<li>If I add the solution as a few-shot prompt it is able to solve the problems, but it forgets to
   simplify the result many times.</li>
<li>I can automate the simplification in the print, and that leads to perfect answers. It returns
   the correct answer 5 out of 5 runs.</li>
<li>If I try the baseline few-shot prompt with automatic simplification the problem is not solved anytime
   despite trying with different temperatures.</li>
<li>If I ask GPT4 to create a similar problem, it reaches perfect solution. This suggests that if I give
   similar problems in the few-shot prompt I could boost the score. That also works with humans, if we
   are shown sample problems or sample code solutions that is very helpful for solving the problem.</li>
</ol>
<p>It is worth saying that among all the experiments the model was able to reach the correct answer twice
without using code. It wasn't able to do the same with code unless receiving a very similar problem in
the few-shot prompt.</p>
<h3 id="cheating-to-overfit-on-train-set">Cheating to overfit on train set</h3>
<p>I have solved all the train set problems. Now I'm going to create a few shot prompt with random solutions
from the train set. That is cheating, because the solution is on the prompt, but it is worth trying.</p>
<p>The outcome is the expected, the system is able to reach the correct answer for all the problems.</p>
<p>I'm going to use this few-shot prompt to make submissions.</p>
<h3 id="number-of-repetitions">Number of repetitions</h3>
<p>Self-consistency is a technique that makes multiple predictions for the same problem and returns the
most frequent answer. Intuition says that the higher the number of predictions the most likely the returned
answer will be correct.</p>
<table>
<thead>
<tr>
<th>repetitions</th>
<th>LB score</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>15</td>
</tr>
<tr>
<td>8</td>
<td>20</td>
</tr>
<tr>
<td>12</td>
<td>19</td>
</tr>
</tbody>
</table>
<p>The results show an improvement when increasing the repetitions from 4 to 8, but not from 8 to 12.
It might be randomness or maybe we need more resolution.</p>
<h3 id="max-output-tokens">Max output tokens</h3>
<table>
<thead>
<tr>
<th>max output tokens</th>
<th>LB score</th>
</tr>
</thead>
<tbody>
<tr>
<td>512</td>
<td>20</td>
</tr>
<tr>
<td>1024</td>
<td>19</td>
</tr>
<tr>
<td>2048</td>
<td>19</td>
</tr>
</tbody>
</table>
<p>It seems that for the problems that the system is currently solving the number of output tokens
does not need to be big.</p>
<h3 id="temperature">Temperature</h3>
<p>TODO: table with results</p>
<h2 id="conclusion">Conclusion</h2>
<p>DeepSeekMath seems to be capable of solving the train problems if given a similar problem as context
in a few-shot prompt. I have been able to achieve perfect score by giving the exact same problems as input,
but I also have seen that givin similar problems works.</p>
<p>It does not follow the instructions too well, is better to give examples with few-shot prompt.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>I might try to replicate or even improve the results of DeepSeekMath on MATH dataset.</li>
<li>Bigger context window will increase the chance of having a similar problem in the prompt</li>
<li>A good embedding model will also increase the likelihood of solving the problem, because more relevant
  problems will be given as context.</li>
<li>Could I verify the answers to the problems? Instead of relying on self-consistency.</li>
<li>Optimizing the inference speed will be very helpful.</li>
</ul>
<h2 id="todo">TODO</h2>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Problems when generating loops. https://huggingface.co/docs/transformers/en/main_classes/text_generation. That is <code>frequency_penalty</code> on OpenAI but on huggingface there are other options.</li>
<li class="task-list-item"><input type="checkbox" disabled/> Analyze deepseekmath library and define experiments</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Lower temperature when using few-shot to see if it returns more boxed answers. Shuffle the input examples to induce variability.</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Submission with 9 few-shot examples</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Submission with 12 repetitions</li>
<li class="task-list-item"><input type="checkbox" disabled/> Document results</li>
<li class="task-list-item"><input type="checkbox" disabled checked/> Modify the temperature in the submissions</li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2024-05-07
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Modeling" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Modeling
            </div>
          </div>
        </a>
      
      
        
        <a href="../Iteration_02_MATH_dataset/" class="md-footer__link md-footer__link--next" aria-label="Next: Iteration 2. MATH dataset" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Iteration 2. MATH dataset
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://www.linkedin.com/in/guillermobarbadillo/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/guille_bar" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.youtube.com/channel/UCOHmUwHnd2hmUpiDzaQ1Isg" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.kaggle.com/ironbar" target="_blank" rel="noopener" title="www.kaggle.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a6c66575.min.js"></script>
      
        <script src="../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>